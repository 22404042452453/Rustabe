# Анализ устойчивости энергосистем с RastrWin

## Описание

Данный проект предоставляет графический интерфейс для анализа устойчивости энергосистем с использованием программного комплекса RastrWin. Позволяет проводить многовариантный анализ по нескольким сценариям.

## Возможности

- **Многовариантный анализ** по нескольким сценариям
- **Два метода расчета** устойчивости: простой (simple) и EMS-режим
- **Автоматическое тестирование** граничных значений мощностей генераторов
- **Мониторинг параметров** генераторов (угол ротора, напряжение, активная/реактивная мощность, ток)
- **Экспорт результатов** в форматы Excel (с вкладками), CSV и JSON
- **Графический интерфейс** для удобной настройки и запуска анализа

## Требования

- **Операционная система:** Windows
- **RastrWin** - программный комплекс для расчетов в электроэнергетике
- **Python 3.6+**
- **Зависимости Python:**
  - `pywin32` - для работы с COM-интерфейсом RastrWin
  - `openpyxl` - для экспорта в Excel (опционально, устанавливается автоматически)
  - `tkinter` - для графического интерфейса (входит в стандартную поставку Python)

## Установка

1. Установите Python 3.6 или выше
2. Установите зависимости:
   ```bash
   pip install pywin32 openpyxl
   ```
3. Убедитесь, что RastrWin установлен и доступен через COM-интерфейс

## Структура проекта

- `analysis_core.py` - основной модуль с классами анализа
- `gui_main.py` - графический интерфейс пользователя

## Использование

### Графический интерфейс

Запустите GUI:

```python
python gui_main.py
```

#### Основные элементы интерфейса:

1. **Конфигурация генераторов**
   - Добавление/удаление генераторов
   - Настройка диапазонов мощностей
   - Указание идентификаторов генераторов

2. **Параметры мониторинга**
   - Угол ротора (Delta)
   - Напряжение (U)
   - Активная мощность (P)
   - Реактивная мощность (Q)
   - Ток (I)

3. **Сценарии анализа**
   - Выбор папки со сценариями (.scn файлы)
   - Выбор файла сети (.rst)

4. **Настройки расчета**
   - Метод: простой расчет или EMS-режим

5. **Результаты**
   - Просмотр результатов в текстовом виде
   - Экспорт в Excel/CSV/JSON

## Форматы экспорта

### Excel (.xlsx)

Создает файл с несколькими вкладками:
- **Мощность** - результаты анализа с мощностями и статусом устойчивости
- **Угол ротора** - значения углов ротора генераторов
- **Напряжение** - значения напряжений генераторов
- **Ток** - значения токов генераторов

### CSV (.csv)

Табличный формат с разделителями ";" для импорта в Excel или другие программы.

### JSON (.json)

Структурированный формат для программной обработки результатов.

## Примеры

### Простой анализ двух генераторов

В интерфейсе добавьте двух генераторов:
- Генератор 1: ID 51804050, диапазон мощности 80-210 МВт
- Генератор 2: ID 51804051, диапазон мощности 100-250 МВт

Программа протестирует комбинации:
- Минимум + минимум: [80, 100] МВт
- Максимум + максимум: [210, 250] МВт
- Среднее + среднее: [145, 175] МВт

### Мониторинг параметров

В разделе "Параметры мониторинга" выберите нужные параметры (угол ротора, напряжение, ток). Результаты будут сохранены в соответствующие вкладки Excel файла.

## Лицензия

Проект распространяется под лицензией MIT.

## Автор

Проект создан для анализа устойчивости энергосистем.
